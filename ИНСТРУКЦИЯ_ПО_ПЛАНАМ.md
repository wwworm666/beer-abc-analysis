# Инструкция по работе с планами

## Файлы

1. **планы_2025_2026.xlsx** - основная таблица с планами на 2025-2026 годы
2. **import_plans_from_excel_new.py** - скрипт импорта планов в систему

## Структура таблицы

Таблица содержит **24 месяца** (весь 2025 и 2026 год).

Для каждого месяца:
- Заголовок месяца (например, "Январь 2025")
- Таблица с метриками и значениями для 4 баров

### Столбцы:
1. **Метрика** - название показателя
2. **Большой пр. В.О** - значения для бара Большой пр. В.О
3. **Лиговский** - значения для бара Лиговский
4. **Кременчугская** - значения для бара Кременчугская
5. **Варшавская** - значения для бара Варшавская
6. **Общая** - значения для агрегированного показателя (все бары вместе)

### Метрики (11 штук):
1. Выручка
2. Прибыль
3. Чеки
4. Средний чек
5. Доля розлив
6. Доля фасовка
7. Доля кухня
8. Наценка
9. Наценка розлив
10. Наценка фасовка
11. Наценка кухня

## Как заполнять планы

1. Откройте файл **планы_2025_2026.xlsx**
2. Найдите нужный месяц (например, "Январь 2025")
3. Заполните значения в столбцах для каждого бара
   - Можно заполнить не все метрики, только нужные
   - Можно заполнить не все бары, только те, для которых есть планы
4. **ВАЖНО:** Сохраните файл (Ctrl+S) и закройте Excel

## Импорт планов в систему

После заполнения таблицы выполните:

```bash
python import_plans_from_excel_new.py
```

Скрипт:
- Прочитает все месяцы из таблицы
- Распределит месячные значения по неделям
- Сохранит в `data/plansdashboard.json`
- Покажет сколько планов создано

## Как работает распределение по неделям

Месячные планы автоматически распределяются по неделям этого месяца.

Например, если в январе 2025 указана выручка 1,000,000:
- Январь содержит 5 недель
- Каждая неделя получит план: 1,000,000 / 5 = 200,000

## Проверка планов

После импорта планы сразу появятся на дашборде в разделе "Плановые показатели".

Если для какой-то недели нет плана - система покажет только фактические данные.

## Примеры заполнения

### Пример 1: Базовые показатели
```
Месяц: Январь 2025

Метрика              | Большой пр. В.О | Лиговский | Кременчугская | Варшавская | Общая
---------------------|-----------------|-----------|---------------|------------|--------
Выручка              | 700000          | 550000    | 500000        | 600000     | 2350000
Прибыль              | 210000          | 165000    | 150000        | 180000     | 705000
Чеки                 | 2800            | 2200      | 2000          | 2500       | 9500
```

### Пример 2: Только некоторые метрики
```
Месяц: Февраль 2025

Метрика              | Большой пр. В.О | Лиговский | Кременчугская | Варшавская | Общая
---------------------|-----------------|-----------|---------------|------------|--------
Выручка              | 720000          |           | 520000        |            |
Доля розлив          | 0.68            | 0.62      | 0.65          | 0.70       |
Наценка розлив       | 3.6             | 3.4       | 3.5           | 3.8        |
```

В этом примере:
- Для Лиговского нет плана по выручке - будет показан только факт
- Для Варшавской нет плана по выручке - будет показан только факт
- Доли и наценки заполнены для всех баров

## Что делать если планы не загрузились

1. Убедитесь, что сохранили и закрыли Excel файл
2. Проверьте, что названия метрик точно совпадают со списком выше
3. Проверьте, что месяц указан в формате "Январь 2025", "Февраль 2025" и т.д.
4. Запустите импорт заново: `python import_plans_from_excel_new.py`
5. Проверьте вывод скрипта - он показывает какие месяцы и бары нашел

## Полезные команды

```bash
# Импорт планов
python import_plans_from_excel_new.py

# Проверка содержимого JSON с планами
# (первые 50 строк)
head -50 data/plansdashboard.json
```
